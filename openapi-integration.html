<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Robota API 문서</title>
  <meta name="description" content="Robota API 문서">
  <link rel="stylesheet" href="/style.css">
  <script>
    // 페이지 로드 시 Docsify 라우팅으로 리다이렉트
    window.onload = function() {
      // history 모드를 위한 리다이렉트 처리
      const currentPath = window.location.pathname;
      
      // HTML 확장자 제거하여 원래 경로로 리다이렉트
      if (currentPath.endsWith('.html')) {
        window.location.href = currentPath.replace('.html', '');
        return;
      }
      
      // 이미 적절한 경로라면 Docsify로 전달
      window.location.href = '/';
    };
  </script>
</head>
<body>
  <div id="content">
    <h1>OpenAPI/Swagger 통합</h1>
<p>Robota는 OpenAPI(이전의 Swagger) 스펙을 자동으로 AI 에이전트의 도구와 함수로 변환하는 기능을 제공합니다. 이를 통해 기존 API를 쉽게 AI 에이전트에 연결하고 활용할 수 있습니다.</p>
<h2>OpenAPI란?</h2>
<p>OpenAPI는 RESTful API를 설명하기 위한 표준화된 스펙으로, API의 엔드포인트, 요청 매개변수, 응답 형식 등을 JSON 또는 YAML 형식으로 정의합니다. 이 스펙을 통해 API 문서 생성, 클라이언트 코드 생성, API 테스트 등이 가능합니다.</p>
<h2>Robota의 OpenAPI 통합 기능</h2>
<p>Robota는 OpenAPI 스펙을 분석하여 각 API 엔드포인트를 AI 에이전트가 사용할 수 있는 함수로 자동 변환합니다. 이렇게 변환된 함수를 통해 AI는 API를 직접 호출하고 결과를 처리할 수 있습니다.</p>
<h2>OpenAPI 도구 생성하기</h2>
<h3>URL에서 OpenAPI 스펙 로드</h3>
<pre><code class="language-typescript">import { Robota, OpenAIProvider, OpenAPIToolkit } from &#39;robota&#39;;

// OpenAPI 스펙에서 도구 생성
const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;);

// Robota 인스턴스 생성 및 도구 등록
const robota = new Robota({
  provider: new OpenAIProvider({
    apiKey: process.env.OPENAI_API_KEY,
    model: &#39;gpt-4&#39;
  })
});

robota.registerTools(apiTools);

// 이제 AI는 API를 호출할 수 있습니다
const result = await robota.run(&#39;오늘 날씨가 어떤가요?&#39;);
</code></pre>
<h3>로컬 파일에서 OpenAPI 스펙 로드</h3>
<pre><code class="language-typescript">import { Robota, OpenAIProvider, OpenAPIToolkit } from &#39;robota&#39;;
import fs from &#39;fs&#39;;

// 로컬 파일에서 OpenAPI 스펙 로드
const specPath = &#39;./api-specs/weather-api.json&#39;;
const apiSpec = JSON.parse(fs.readFileSync(specPath, &#39;utf-8&#39;));

// OpenAPI 스펙에서 도구 생성
const apiTools = await OpenAPIToolkit.fromSpec(apiSpec);

// Robota 인스턴스에 도구 등록
const robota = new Robota({
  provider: new OpenAIProvider({
    apiKey: process.env.OPENAI_API_KEY,
    model: &#39;gpt-4&#39;
  })
});

robota.registerTools(apiTools);
</code></pre>
<h2>API 인증 설정</h2>
<p>많은 API는 인증이 필요합니다. Robota는 다양한 인증 방식을 지원합니다:</p>
<pre><code class="language-typescript">import { Robota, OpenAPIToolkit, APIAuthentication } from &#39;robota&#39;;

// API 키 인증
const apiKeyAuth = new APIAuthentication.ApiKey({
  name: &#39;api_key&#39;,
  value: process.env.API_KEY,
  in: &#39;header&#39; // &#39;header&#39;, &#39;query&#39;, &#39;cookie&#39; 중 하나
});

// Bearer 토큰 인증
const bearerAuth = new APIAuthentication.Bearer({
  token: process.env.BEARER_TOKEN
});

// 기본 인증
const basicAuth = new APIAuthentication.Basic({
  username: process.env.API_USERNAME,
  password: process.env.API_PASSWORD
});

// OAuth2 인증
const oauthAuth = new APIAuthentication.OAuth2({
  token: process.env.OAUTH_TOKEN
});

// 인증 정보와 함께 도구 생성
const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;, {
  authentication: apiKeyAuth
});
</code></pre>
<h2>세분화된 API 액세스 제어</h2>
<p>특정 API 엔드포인트만 AI에게 노출하도록 제한할 수 있습니다:</p>
<pre><code class="language-typescript">import { Robota, OpenAPIToolkit } from &#39;robota&#39;;

// 특정 경로만 포함
const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;, {
  includePaths: [&#39;/weather/*&#39;, &#39;/locations/search&#39;],
  excludePaths: [&#39;/admin/*&#39;, &#39;/users/*&#39;]
});
</code></pre>
<h2>엔드포인트 이름 변경 및 설명 추가</h2>
<p>더 명확한 도구 이름과 설명을 제공할 수 있습니다:</p>
<pre><code class="language-typescript">import { Robota, OpenAPIToolkit } from &#39;robota&#39;;

const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;, {
  nameMapping: {
    &#39;/weather/{city}&#39;: &#39;getWeatherByCity&#39;,
    &#39;/locations/search&#39;: &#39;searchLocations&#39;
  },
  descriptionEnhancement: {
    &#39;/weather/{city}&#39;: &#39;지정된 도시의 현재 날씨 정보를 가져옵니다. 도시 이름은 한글 또는 영어로 입력할 수 있습니다.&#39;
  }
});
</code></pre>
<h2>응답 변환 및 후처리</h2>
<p>API 응답을 가공하여 AI에게 더 유용한 형태로 제공할 수 있습니다:</p>
<pre><code class="language-typescript">import { Robota, OpenAPIToolkit } from &#39;robota&#39;;

const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;, {
  responseTransformers: {
    &#39;/weather/{city}&#39;: (response) =&gt; {
      // 응답 데이터 변환
      return {
        temperature: response.data.temp,
        condition: response.data.weather[0].description,
        location: response.data.name,
        summary: `${response.data.name}의 현재 날씨는 ${response.data.weather[0].description}이고, 기온은 ${response.data.temp}°C입니다.`
      };
    }
  }
});
</code></pre>
<h2>에러 처리</h2>
<p>API 호출 중 발생하는 오류를 적절히 처리할 수 있습니다:</p>
<pre><code class="language-typescript">import { Robota, OpenAPIToolkit } from &#39;robota&#39;;

const apiTools = await OpenAPIToolkit.fromURL(&#39;https://api.example.com/openapi.json&#39;, {
  errorHandlers: {
    &#39;/weather/{city}&#39;: (error) =&gt; {
      if (error.response?.status === 404) {
        return { error: &#39;도시를 찾을 수 없습니다. 도시 이름을 다시 확인해주세요.&#39; };
      }
      if (error.response?.status === 401) {
        return { error: &#39;API 키가 유효하지 않습니다.&#39; };
      }
      return { error: &#39;날씨 정보를 가져오는 중 오류가 발생했습니다.&#39; };
    }
  }
});
</code></pre>
<h2>실제 사용 예시</h2>
<p>OpenAPI로 정의된 날씨 API를 활용하는 에이전트 구현:</p>
<pre><code class="language-typescript">import { Robota, OpenAIProvider, OpenAPIToolkit } from &#39;robota&#39;;
import dotenv from &#39;dotenv&#39;;
dotenv.config();

async function createWeatherAgent() {
  // 날씨 API 도구 생성
  const weatherTools = await OpenAPIToolkit.fromURL(&#39;https://api.weatherapi.com/v1/openapi.json&#39;, {
    authentication: new APIAuthentication.ApiKey({
      name: &#39;key&#39;,
      value: process.env.WEATHER_API_KEY,
      in: &#39;query&#39;
    }),
    includePaths: [&#39;/current.json&#39;, &#39;/forecast.json&#39;],
    nameMapping: {
      &#39;/current.json&#39;: &#39;getCurrentWeather&#39;,
      &#39;/forecast.json&#39;: &#39;getWeatherForecast&#39;
    }
  });

  // Robota 인스턴스 생성 및 도구 등록
  const robota = new Robota({
    provider: new OpenAIProvider({
      apiKey: process.env.OPENAI_API_KEY,
      model: &#39;gpt-4&#39;
    }),
    systemPrompt: &#39;당신은 날씨 정보를 제공하는 도우미입니다. 사용자에게 유용한 날씨 정보를 알려주세요.&#39;
  });

  robota.registerTools(weatherTools);
  
  return robota;
}

// 날씨 에이전트 사용
async function main() {
  const weatherAgent = await createWeatherAgent();
  
  const result = await weatherAgent.run(&#39;서울의 오늘 날씨는 어때? 그리고 내일은 비가 올 예정이야?&#39;);
  console.log(result);
}

main().catch(console.error);
</code></pre>

  </div>
</body>
</html>